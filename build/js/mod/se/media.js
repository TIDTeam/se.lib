/*! Copyright (c) SESHENGHUO.COM - Author: LIJUN - Email: zwlijun@gmail.com - Git: https://github.com/zwlijun/se.lib */
define(function a(require,exports,module){$.Util=require("mod/se/util");var b=(window.MediaType={AUDIO:"audio",VIDEO:"video"},{MP3:{type:"/mpeg",codec:{audio:"",video:""}},MP4:{type:"/mp4",codec:{audio:"mp4a.40.5",video:"avc1.4D401E, mp4a.40.2"}},OGG:{type:"/ogg",codec:{audio:"vorbis",video:"theora, vorbis"}},WAV:{type:"/wav",codec:{audio:"",video:""}},WEBM:{type:"/webm",codec:{audio:"",video:"vp8.0, vorbis"}},parse:function(a,c){var d=/\.(mp3|mp4|ogg|wav|webm)(\?.*)?$/gi,e=null,f=null,g=null;if(null!=(e=d.exec(c)))return f=e[1].toUpperCase(),g=b[f],g.type=a+g.type,g;throw new Error(" the media type is not supported, source("+c+")")}}),c=function(c,d,e,f){this.type=c||a.AUDIO,this.src=e||"",this.name=d||"se_"+this.type,this.mime=b.parse(this.type,this.src),this.bubble="boolean"==typeof f?f:!0,this.mediaNode=$("#"+this.name)};c.prototype={setProperty:function(a,b){this.mediaNode.prop(a,b)},getProperty:function(a){return this.mediaNode.prop(a)},source:function(a,b){var c=$("<source />");c.attr("src",a),c.attr("type",b),this.mediaNode.append(c)},on:function(){this.mediaNode.on.apply(this.mediaNode,arguments)},off:function(){this.mediaNode.off.apply(this.mediaNode,arguments)},addTextTrack:function(a,b,c){return this.mediaNode[0].addTextTrack(a,b,c)},canPlayType:function(a){return this.mediaNode[0].canPlayType(a)},load:function(){this.mediaNode[0].load()},play:function(){this.mediaNode[0].play()},pause:function(){this.mediaNode[0].pause()},cancelBubble:function(a){a.stopPropagation()},insert:function(a,b,c){if(0==this.mediaNode.length){var d=c?"video":this.type;if(this.mediaNode=$("<"+d+" />"),!this.canPlayType(this.mime.type))throw new Error("the media dose not support this MIME type("+this.mime.type+")");for(var e in b)b.hasOwnProperty(e)&&this.setProperty(e,b[e]);this.setProperty("id",this.name),this.setProperty("src",this.src),this.source(this.src,this.mime.type),this.mediaNode.append("Your browser does not support the "+d+" element."),$(a).append(this.mediaNode),!0===this.bubble&&$(a).on("touchstart",this.cancelBubble).on("touchmove",this.cancelBubble).on("touchend",this.cancelBubble)}}};var d={newInstance:function(a,b,d,e){var f=new c(a,b,d,e);return{setProperty:function(a,b){f.setProperty(a,b)},getProperty:function(a){return f.getProperty(a)},on:function(){f.on.apply(f,arguments)},off:function(){f.off.apply(f,arguments)},addTextTrack:function(a,b,c){return f.addTextTrack(a,b,c)},canPlayType:function(a){return f.canPlayType(a)},load:function(){f.load()},play:function(){f.play()},pause:function(){f.pause()},insert:function(a,b,c){f.insert(a,b,c)}}}};module.exports=d});