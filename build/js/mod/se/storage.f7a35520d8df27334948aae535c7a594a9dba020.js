/*! Copyright (c) SESHENGHUO.COM - Author: LIJUN - Email: zwlijun@gmail.com - Git: https://github.com/zwlijun/se.lib */
define(function(require,exports,module){var a=function(){this.db={},this.key="SE_STORAGE_BLOCK"};a.prototype={expired:function(a,b){if(b&&b.expired){var c=(new Date).getTime(),d=c-b.expired>=0;return!0===d&&this.remove(a),d}return!1},put:function(a,b){this.db[a]=b},get:function(a){if(a in this.db){var b=this.db[a];return this.expired(a,b)?null:b}return null},remove:function(a){a in this.db&&delete this.db[a]},clear:function(){this.db={}},toString:function(){var a={};for(var b in this.db)this.db.hasOwnProperty(b)&&(this.expired(b,this.db[b])?this.remove(b):a[b]=this.db[b]);JSON.stringify(a)}};var b=new a,c=new a,d=(new a,{supported:-1,set:function(a,c,d){b.put(a,{value:c,expired:d||0,timestamp:(new Date).getTime()}),this.flush()},get:function(a){var c=b.get(a),d=null,e=null,g=null;return null!=c?e=c.value:this.support()?(d=window.localStorage.getItem(b.key)||"{}",g=$.parseJSON(d),a in g&&(c=b.expired(g[a])?null:g[a],e=null==c?null:c.value)):e=f.get(a,b),e},remove:function(a){var c=null;this.support()?(c=window.localStorage.getItem(b.key)||"{}",b.db=$.parseJSON(c),b.remove(a),this.flush()):f.remove(a,b)},clear:function(){this.support()?(b.clear(),this.flush()):f.clear(b)},flush:function(){this.support()?window.localStorage.setItem(b.key,b.toString()):f.flush(b)},support:function(){var a=!1,b="SE_CACHE_SUPPORT",c=this.supported;if(-1!=c)return c;try{var d=window.localStorage;d.setItem(b,"1"),a="1"==d.getItem(b),this.supported=a,d.removeItem(b)}catch(e){}finally{return a}}}),e={supported:-1,set:function(a,b){c.put(a,{value:b,expired:0,timestamp:(new Date).getTime()}),this.flush()},get:function(a){var b=c.get(a),d=null,e=null,g=null;return null!=b?e=b.value:this.support()?(d=window.sessionStorage.getItem(c.key)||"{}",g=$.parseJSON(d),a in g&&(b=c.expired(g[a])?null:g[a],e=null==b?null:b.value)):e=f.get(a,c),e},remove:function(a){var b=null;this.support()?(b=window.sessionStorage.getItem(c.key)||"{}",c.db=$.parseJSON(b),c.remove(a),this.flush()):f.remove(a,c)},clear:function(){this.support()?(c.clear(),this.flush()):f.clear(c)},flush:function(){this.support()?window.sessionStorage.setItem(c.key,c.toString()):f.flush(c)},support:function(){var a=!1,b="SE_CACHE_SUPPORT",c=this.supported;if(-1!=c)return c;try{var d=window.sessionStorage;d.setItem(b,"1"),a="1"==d.getItem(b),this.supported=a,d.removeItem(b)}catch(e){}finally{return a}}},f={get:function(a,b){var c=b.get(a),d=null,e=null,f=null;return null!=c?e=c.value:(d=window.name||"{}",f=$.parseJSON(d),a in f&&(c=b.expired(f[a])?null:f[a],e=null==c?null:c.value)),e},remove:function(a,b){var c=window.name||"{}";b.db=$.parseJSON(c),b.remove(a),this.flush(b)},clear:function(a){a.clear(),this.flush(a)},flush:function(a){window.name=a.toString()}};module.exports={Persistent:d,Session:e}});